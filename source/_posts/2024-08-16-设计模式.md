---
title: è®¾è®¡æ¨¡å¼
author: cotes
date: 2024-08-16 11:33:00 +0800
categories: [å­¦ä¹ ]
tags: [å­¦ä¹ ]
pin: true
math: true
mermaid: true

---

### å•ä½“æ¨¡å¼

å•ä½“æ¨¡å¼çš„æ€æƒ³åœ¨äºä¿è¯ä¸€ä¸ªç‰¹å®šçš„ç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ã€‚è¿™æ„å‘³ç€ç¬¬äºŒæ¬¡ä½¿ç”¨åŒä¸€ä¸ªç±»åˆ›å»ºæ–°å¯¹è±¡çš„æ—¶å€™ï¼Œåº”è¯¥å¾—åˆ°ä¸ç¬¬ä¸€æ¬¡æ‰€åˆ›å»ºå¯¹è±¡å®Œå…¨ç›¸åŒ

jsä¸­æ²¡æœ‰ç±»ï¼Œåªæœ‰å¯¹è±¡ï¼Œåˆ›å»ºæ–°å¯¹è±¡å°±å·²ç»æ˜¯å•ä½“äº†

```
var obj = {}
```

> jsä¸­å¯¹è±¡ä¹‹é—´æ°¸è¿œä¸ä¼šç›¸ç­‰ï¼Œé™¤éæ˜¯åŒä¸€å¯¹åƒï¼Œæ‰€ä»¥æ¯æ¬¡ä½¿ç”¨å¯¹è±¡å­—é¢é‡åˆ›å»ºå¯¹è±¡å°±æ˜¯åˆ›å»ºä¸€ä¸ªå•ä½“

#### ä½¿ç”¨newæ“ä½œç¬¦

```
var a = new Foo()
var b = new Foo()
a === b //true
```

ä¸Šé¢ä»£ç ä¸­ï¼Œaå¯¹è±¡ä»…åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ„é€ å‡½æ•°æ—¶åˆ›å»ºã€‚ç¬¬äºŒæ¬¡åˆ›å»ºæ—¶å°†è¿”å›åŒä¸€ä¸ªaå¯¹è±¡ï¼Œä½¿å¾—a === bï¼Œæœ¬è´¨ä¸Šæ˜¯æŒ‡ç›¸åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨

jså®ç°å•ä½“éœ€è¦Fooæ„é€ å‡½æ•°ç¼“å­˜è¯¥å¯¹è±¡å®ä¾‹thisï¼Œä»¥ä¾¿ç¬¬äºŒæ¬¡è°ƒç”¨è¯¥æ„é€ å‡½æ•°æ—¶èƒ½å¤Ÿåˆ›å»ºå¹¶è¿”å›åŒä¸€ä¸ªå¯¹è±¡ã€‚å®ç°è¿™ä¸€ç›®çš„æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼š

- ä½¿ç”¨å…¨å±€å˜é‡å­˜å‚¨è¯¥å®ä¾‹ã€‚ä¸è¿‡å…¨å±€å˜é‡æ˜¯æœ‰ç¼ºç‚¹çš„ï¼Œä¸ç¬¦åˆä¸€èˆ¬æ€§åŸåˆ™ï¼Œä»»ä½•äººéƒ½èƒ½è¦†ç›–å…¨å±€å˜é‡
- åœ¨æ„é€ å‡½æ•°çš„é™æ€å±æ€§ä¸­ç¼“å­˜è¯¥å®ä¾‹ã€‚å¯ä»¥ä½¿ç”¨ç±»ä¼¼`Foo.instance`çš„å±æ€§å°†å®ä¾‹ç¼“å­˜åœ¨è¯¥å±æ€§ä¸­ï¼Œè¿™ç§æ–¹æ¡ˆçš„ç¼ºç‚¹æ˜¯instanceå±æ€§æ˜¯å…¬å¼€å¯è®¿é—®çš„å±æ€§ï¼Œä»£ç å¤–éƒ¨ä¸­å¯èƒ½ä¼šä¿®æ”¹è¯¥å±æ€§
- å°†è¯¥å®ä¾‹åŒ…è£…åœ¨é—­åŒ…ä¸­ã€‚è¿™æ ·å¯ä»¥ä¿è¯å®ä¾‹çš„ç§æœ‰æ€§ï¼Œä»£ä»·æ˜¯å¸¦æ¥äº†é¢å¤–çš„é—­åŒ…å¼€é”€

##### é™æ€å±æ€§å®ä¾‹

ç¤ºä¾‹ï¼š

```
function Foo() {
    if (typeof Foo.instance === 'object') {
        return Foo.instance
    }
    //åŠ å…¥å±æ€§
    this.s_time = 0
    this.bang = 'big'
    // ç¼“å­˜
    Foo.instance = this
    // éšå¼è¿”å›
    // return this
}

var a = new Foo()
var b = new Foo()
a === b// true
```

##### é—­åŒ…ä¸­çš„å®ä¾‹

ç¤ºä¾‹ï¼š

```
function Foo() {
    // ç¼“å­˜å®ä¾‹
    var instance
    // é‡å†™æ„é€ å‡½
    Foo = function Foo() {
        return instance
    }
    // ä¿ç•™åŸå‹å±æ€§
    Foo.prototype = this
    // å®ä¾‹
    instance = new Foo()
    // é‡ç½®æ„é€ å‡½æ•°æŒ‡é’ˆ
    instance.constructor = Foo
    // æ·»åŠ å±æ€§
    this.s_time = 0
    this.bang = "big"
    return instance
}
var a = new Foo()
var b = new Foo()
a === b// true
```

### å·¥å‚æ¨¡å¼

å·¥å‚æ¨¡å¼çš„ç›®çš„æ˜¯ä¸ºäº†åˆ›å»ºå¯¹è±¡ã€‚é€šå¸¸ä»¥ç±»æˆ–ç±»é™æ€æ–¹æ³•å®ç°ï¼Œæœ‰ä»¥ä¸‹è®¾è®¡ç›®æ ‡ï¼š

- åˆ›å»ºç›¸ä¼¼å¯¹è±¡æ—¶æ‰§è¡Œé‡å¤æ“ä½œã€‚
- ç¼–è¯‘ä¸çŸ¥é“å…·ä½“ç±»å‹ï¼ˆç±»ï¼‰çš„æƒ…å†µä¸‹ï¼Œä¸ºå·¥å‚å®¢æˆ·æä¾›ä¸€ç§åˆ›å»ºå¯¹è±¡çš„æ¥å£ã€‚

ç¤ºä¾‹ï¼š

```
// çˆ¶æ„é€ å‡½æ•°
function Maker() { }
Maker.prototype.foo = function () {
    return "foo" + this.name
}
//å·¥å‚æ–¹æ³•
Maker.factor = function (type) {
    var constr = type, str;

    if (typeof Maker[constr] !== "function") {
        throw {
            name: "Error",
            message: constr + "doesn't exist"
        }
    }
    if (typeof Maker[constr].prototype.foo !== "function") {
        Maker[constr].prototype = new Maker()
    }
    str = new Maker[constr]()
    return str
}
Maker.bar = function () {
    this.name = "bar"
}
var corolla = Maker.factor('bar')
console.log(corolla.foo()) //foobar
```

### è¿­ä»£å™¨æ¨¡å¼

è¿­ä»£å™¨é€šå¸¸æ˜¯ä¸€ä¸ªåŒ…å«æŸç§æ•°æ®é›†åˆçš„å¯¹è±¡ã€‚è¯¥æ•°æ®å¯èƒ½å­˜å‚¨åœ¨ä¸€ä¸ªå¤æ‚æ•°æ®ç»“æ„å†…éƒ¨ï¼Œéœ€è¦æä¾›ä¸€ä¸ªç®€å•çš„æ–¹æ³•è®¿é—®æ•°æ®ç»“æ„ä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚æ¶ˆè´¹è€…åªéœ€è¦å–å‡ºå•ä¸ªæ•°æ®è¿›è¡Œå·¥ä½œã€‚

```
var gen = (function () {
    var index = 0, data = [1, 2, 3, 4, 5], length = data.length;
    return {
        next: function () {
            var ele;
            if (!this.hasNext()) {
                return null
            }
            ele = data[index]
            index = index + 2
            return ele
        },
        hasNext: function () {
            return index < length
        },
        rewind: function () {
            index = 0
        },
        current: function () {
            return data[index]
        }
    }
}())

while (gen.hasNext()) {
    console.log(gen.next())
}
```

### è£…é¥°è€…æ¨¡å¼

è£…é¥°è€…æ¨¡å¼å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€æ·»åŠ é™„åŠ åŠŸèƒ½åˆ°å¯¹è±¡ä¸­ã€‚

```
// æ·»åŠ ä¸€ä¸ªåŸå‹æ–¹æ³•å’Œæ„é€ å‡½æ•°
function trimmer(options) {
    this.options = options || {}
}

trimmer.prototype.getTrimmer = function () {
    return this.options
}
// å®ç°è£…é¥°è€…å¯¹è±¡
trimmer.decorators = {}

// æ·»åŠ è£…é¥°è€…
trimmer.decorators.foo = {
    getTrimmer: function () {
        var options = this.uber.getTrimmer()
        options += options * 5 / 100
        return options
    }
}

trimmer.prototype.decorate = function (decorate) {
    var F = function () { },
        overrides = this.constructor.decorators[decorate],
        i, newObj
    F.prototype = this;
    newObj = new F()
    newObj.uber = F.prototype;
    for (i in overrides) {
        if (overrides.hasOwnProperty(i)) {
            newObj[i] = overrides[i]
        }
    }
    return newObj;
}
let tri = new trimmer("bar") // options: 'bar'
tri.decorate("foo")
```

#### ä½¿ç”¨åˆ—è¡¨å®ç°

```
function trimmer(options) {
    this.options = options || {}
    this.decorators_list = []
}

trimmer.prototype.decorate = function (decorate) {
    this.decorators_list.push(decorate)
}
trimmer.prototype.getOptions = function () {
    var options = this.options, i, max = this.decorators_list.length, name
    for (i = 0; i < max; i++) {
        name = this.decorators_list[i]
        options = trimmer.decorators[name].getTrimmer(options)
    }
    return options
}
```

### ç­–ç•¥æ¨¡å¼

æ­¤æ¨¡å¼æ”¯æŒåœ¨è¿è¡Œæ—¶é€‰æ‹©ç®—æ³•ã€‚

å®ç°ä¸€ä¸ªè¡¨å•éªŒè¯å™¨ï¼š

```
var validator = {
    // å¯ç”¨æ£€æŸ¥
    types: {},
    // é”™è¯¯æ¶ˆæ¯
    message: [],
    //éªŒè¯ç±»å‹
    config: {},
    // æ¥å£æ–¹æ³•
    validate: function (data) {
        var i, msg, type, check, result_ok;
        this.message = []
        for (i in data) {
            if (data.hasOwnProperty(i)) {
                type = this.config[i]
                check = this.types[type]
                if (!type) {
                    continue;
                }
                if (!check) {
                    throw {
                        name: "ValidationError",
                        message: 'éªŒè¯ç©ºç±»å‹' + type
                    }
                }

                result_ok = check.validate(data[i])
                if (!result_ok) {
                    msg = "æ ¡éªŒå€¼" + i + "," + check.instructions;
                    this.message.push(msg)
                }
            }
        }
        return this.hasErrors()
    },
    hasErrors: function () {
        return this.message.length !== 0
    }
}

validator.types.isNonEmpty = {
    validate: function (value) {
        return value !== "";
    },
    instructions: "ä¸èƒ½ä¸ºç©º"
}
validator.types.isNumber = {
    validate: function (value) {
        return !isNaN(value)
    },
    instructions: "åªèƒ½ä¸ºæ•°å­—å½¢å¼"
}
validator.types.isAlphaNum = {
    validate: function (value) {
        return !/[^a-z0-9]/i.test(value)
    },
    instructions: "ç”±æ•°å­—å’Œå­—æ¯ç»„æˆ"
}

var data = {
    userName: "ğŸ˜„ï¸",
    firstName: "ğŸ˜¸ï¸",
    age: "unknown"
}
validator.config = {
    userName: "isAlphaNum",
    firstName: "isNonEmpty",
    age: "isNumber"
}

validator.validate(data)
```

### å¤–è§‚æ¨¡å¼

æ­¤æ¨¡å¼ä¸ºå¯¹è±¡æä¾›ä¸€ä¸ªå¯ä¾›é€‰æ‹©çš„æ¥å£ã€‚å¤–è§‚æ¨¡å¼å¯¹é‡æ„å’Œé‡æ–°è®¾è®¡ä»£ç ä¹Ÿå¾ˆæœ‰å¸®åŠ©ã€‚é€šè¿‡å¤–è§‚æ¨¡å¼å¯ä»¥ä¼˜å…ˆè€ƒè™‘æ–°å¯¹è±¡çš„APIï¼Œåœ¨åŸæœ‰å¯¹è±¡å‰é¢åˆ›å»ºä¸€ä¸ªå¤–è§‚ã€‚è¿™æ ·ä»…é¡»ä¿®æ”¹å°‘é‡ä»£ç å°±å¯ä»¥å–ä»£åŸæœ‰å¯¹è±¡ã€‚

å½“å¤„ç†æµè§ˆå™¨äº‹ä»¶æ—¶æœ‰ä¸¤ä¸ªæ–¹æ³•ä¾›è°ƒç”¨ï¼š

```
stopPropagation()

preventDefault()
```

å½“éœ€è¦åŒæ—¶è°ƒç”¨æ—¶å¯ä»¥åˆ›å»ºä¸€ä¸ªå¤–è§‚æ–¹æ³•åŒæ—¶è°ƒç”¨è¿™ä¸¤ä¸ªæ–¹æ³•

```
var event = {
	stop: function(e) {
		e.stopPropagation();
		e.preventDefault()
	}
}
```

### ä»£ç†æ¨¡å¼

ä»£ç†æ¨¡å¼ä¸­ï¼Œä¸€ä¸ªå¯¹è±¡å……å½“å¦ä¸€ä¸ªå¯¹è±¡çš„æ¥å£ã€‚ä»£ç†å……å½“äº†æŸä¸ªå¯¹è±¡çš„å®ˆæŠ¤å¯¹è±¡ï¼Œå¹¶è¯•å›¾ä½¿æœ¬ä½“å¯¹è±¡åšå°½å¯èƒ½å°‘çš„å·¥ä½œã€‚

ç¤ºä¾‹ï¼š

```
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <p><span id="toggle-all">toggle checked</span></p>
    <ol id="vids">
      <li>
        <input type="checkbox" checked />
        <a href="https://www.bilibili.com/video/BV1Zs411A717?p=1">paly1</a>
      </li>
      <li>
        <input type="checkbox" checked />
        <a href="https://www.bilibili.com/video/BV1Zs411A717?p=2">paly2</a>
      </li>
      <li>
        <input type="checkbox" checked />
        <a href="https://www.bilibili.com/video/BV1Zs411A717?p=3">paly3</a>
      </li>
      <li>
        <input type="checkbox" checked />
        <a href="https://www.bilibili.com/video/BV1Zs411A717?p=4">paly4</a>
      </li>
      <li>
        <input type="checkbox" checked />
        <a href="https://www.bilibili.com/video/BV1Zs411A717?p=5">paly5</a>
      </li>
    </ol>
  </body>
  <script>
    var $ = function (id) {
      return document.getElementById(id);
    };
    var videos = {
      getPlayer: function (id) {},
      updateList: function (data) {},
      getInfo: function (id) {
        var info = $("info" + id);
        if (!info) {
          http.makeRequest([id], "?p=", "https://www.bilibili.com/");
          return;
        }
        if (info.style.display == "none") {
          info.style.display = "";
        } else {
          info.style.display = "none";
        }
      },
    };
    var http = {
      makeRequest: function (ids, callback, url) {
        var url = url,
          sql = "video/BV1Zs411A717",
          handler = callback,
          script = document.createElement("script");

        url += sql + handler + ids;
        script.src = url;
        console.log(script);
        document.body.appendChild(script);
      },
    };
    // ä»£ç†ä»£ç 
    var proxy = {
      ids: [],
      delay: 50,
      timeout: null,
      callback: null,
      context: null,
      makeRequest: function (id, callback, context) {
        this.ids.push(id);
        this.callback = callback;
        this.context = context;
        if (!this.timeout) {
          this.timeout = setTimeout(function () {
            proxy.flush();
          }, this.delay);
        }
      },
      flush: function () {
        http.makeRequest(this.ids, "proxy.handler");
        this.timeout = null;
        this.ids = [];
      },
      handler: function (data) {
        var i, max;
        if (parseInt(data.query.count, 10) === 1) {
          proxy.callback.call(proxy.context, data.query.results.Video);
          return;
        }
        for (i = 0, max = data.query.results.Video.length; i < max; i++) {
          proxy.callback.call(proxy.context, data.query.results.Video[i]);
        }
      },
    };
    $("vids").onclick = function (e) {
      var src, id;
      e = e || window.event;
      src = e.target || e.srcElement;
      if (src.nodeName !== "A") {
        return;
      }
      if (typeof e.preventDefault === "function") {
        e.preventDefault();
      }
      e.returnValue = false;
      id = src.href.split("?p=")[1];
      if (src.className === "play") {
        src.parentNode.innerHTML = videos.getPlayer(id);
        return;
      }
      src.parentNode.id = "v" + id;
      videos.getInfo(id);
    };
    $("toggle-all").onclick = function (e) {
      var link, i, max, id;
      link = $("vids").getElementsByTagName("a");
      for (i = 0, max = link.length; i < max; i++) {
        if (link[i].className === "play") {
          continue;
        }
        if (!link[i].parentNode.firstChild.checked) {
          continue;
        }
        id = link[i].href.split("?p=")[1];
        link[i].parentNode.id = "v" + id;
        videos.getInfo(id);
      }
    };
  </script>
</html>

```

### ä¸­ä»‹è€…æ¨¡å¼

åº”ç”¨ç¨‹åºæ— è®ºå¤§å°ï¼Œéƒ½æ˜¯ç”±ä¸€äº›å•ä¸ªçš„å¯¹è±¡ç»„æˆã€‚å½“è¿™äº›å¯¹è±¡éœ€è¦ä¸€ç§æ–¹å¼æ¥å®ç°ç›¸äº’é€šä¿¡ï¼Œè¿™ç§é€šä¿¡ä¸€å®šç¨‹åº¦ä¸Šå¹¶ä¸é™ä½å¯¹ä»£ç çš„å¯ç»´æŠ¤æ€§ï¼Œä¹Ÿä¸ä¼šç ´åç¨‹åºçš„å®Œæ•´æ€§ã€‚ä½†æ˜¯éšç€åº”ç”¨ç¨‹åºçš„å¢é•¿ï¼Œå°†æ·»åŠ è¶Šæ¥è¶Šå¤šçš„å¯¹è±¡ã€‚è¿™æœŸé—´ä»£ç ç»å†å¤šæ¬¡å¢åˆ æ”¹ã€‚å½“å¯¹è±¡è†¨èƒ€çš„è¶Šæ¥è¶Šå¤§ï¼Œä¸å¯é¿å…åœ°å¯¹è±¡ç›¸äº’é€šä¿¡è¶Šæ¥è¶Šå¤šï¼Œè¿™å°†ä¼šå¯¼è‡´ä¸è‰¯çš„è€¦åˆé—®é¢˜ã€‚è¿™æ ·å¯¼è‡´åæœŸæœ€ç®€å•çš„ä¿®æ”¹å°†ä¹Ÿå˜å¾—ä¸å®¹æ˜“ï¼Œå‡ ä¹æ— æ³•ä¼°è®¡ä¿®æ”¹èŠ±è´¹çš„æ—¶é—´ã€‚ä¸­ä»‹è€…æ¨¡å¼ç¼“è§£äº†è¿™ä¸ªé—®é¢˜ï¼Œä¿ƒè¿›å½¢æˆæ¾è€¦åˆå¹¶ä¸”æœ‰åŠ©äºæé«˜å¯ç»´æŠ¤æ€§ã€‚

ç¤ºä¾‹ï¼š

```
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <p>ç©å®¶1æ•²å‡»é”®ç›˜ä¸Šçš„1ï¼Œç©å®¶2æ•²å‡»é”®ç›˜ä¸Šçš„0ï¼ˆåªæœ‰ä¸€åˆ†é’Ÿçš„æ—¶é—´ï¼ï¼‰</p>
    <div id="results"></div>
  </body>
  <script>
    function Player(name) {
      this.points = 0;
      this.name = name;
    }

    Player.prototype.play = function () {
      this.points += 1;
      mediator.played();
    };

    var scoreboard = {
      element: document.getElementById("results"),
      update: function (score) {
        var i,
          msg = "";
        for (i in score) {
          if (score.hasOwnProperty(i)) {
            msg += `<p><strong>${i}</strong>:${score[i]}</p>`;
          }
        }
        this.element.innerHTML = msg;
      },
    };

    var mediator = {
      players: {},
      setup: function () {
        var players = this.players;
        players.home = new Player("Hone");
        players.guest = new Player("Guest");
      },
      played: function () {
        var players = this.players,
          score = {
            Home: players.home.points,
            Guest: players.guest.points,
          };
        scoreboard.update(score);
      },
      keypress: function (e) {
        e = e || window.event;
        if (e.which === 49) {
          mediator.players.home.play();
          return;
        }
        if (e.which === 48) {
          mediator.players.guest.play();
          return;
        }
      },
    };
    mediator.setup();
    window.onkeypress = mediator.keypress;

    setTimeout(function () {
      window.onkeypress = null;
      alert("æ¸¸æˆç»“æŸ ï¼");
    }, 30000);
  </script>
</html>

```

### è§‚å¯Ÿè€…æ¨¡å¼

æ­¤æ¨¡å¼æ˜¯ä¸€ä¸ªå¯¹è±¡è®¢é˜…å¦å¤–ä¸€ä¸ªå¯¹è±¡çš„ç‰¹å®šæ´»åŠ¨å¹¶åœ¨çŠ¶æ€æ”¹å˜åè·å¾—é€šçŸ¥ï¼Œè®¢é˜…è€…ä¹Ÿè¢«ç§°ä¹‹ä¸ºè§‚å¯Ÿè€…ï¼Œè¢«è§‚å¯Ÿçš„å¯¹è±¡ç§°ä¸ºå‘å¸ƒè€…æˆ–ä¸»é¢˜

ç¤ºä¾‹1:

```
var publisher = {
    subscribers: {
        any: []
    },
    subscribe: function (fn, type) {
        type = type || 'any'
        if (typeof this.subscribers[type] === "undefined") {
            this.subscribers[type] = []
        }
        this.subscribers[type].push(fn)
    },
    unsubscribe: function (fn, type) {
        this.visitSubscribers('unsubscribe', fn, type)
    },
    publish: function (publication, type) {
        this.visitSubscribers('publish', publication, type)
    },
    visitSubscribers: function (action, arg, type) {
        var pubType = type || 'any',
            subscribers = this.subscribers[pubType],
            i,
            max = subscribers.length;
        for (i = 0; i < max; i++) {
            if (action === 'publish') {
                subscribers[i](arg)
            } else {
                if (subscribers[i] === arg) {
                    subscribers.splice(i, 1)
                }
            }
        }
    }
}
function makePublisher(o) {
    var i
    for (i in publisher) {
        if (publisher.hasOwnProperty(i) && typeof publisher[i] === "function") {
            o[i] = publisher[i]
        }
    }
    o.subscribers = { any: [] }
}

var paper = {
    daily: function () {
        this.publish('ä»Šå¤©æœ‰å¤§æ–°é—»ï¼ï¼ï¼')
    },
    monthly: function () {
        this.publish("åˆ†æ", "monthly")
    }
}

makePublisher(paper)

var joe = {
    drinkCoffee: function (paper) {
        console.log("é˜…è¯»" + paper)
    },
    sundayPreNap: function (monthly) {
        console.log('å‚¬çœ çš„æ–‡ç« ', monthly)
    }
}
paper.subscribe(joe.drinkCoffee)
paper.subscribe(joe.sundayPreNap, 'monthly')

paper.daily()
paper.daily()
paper.daily()
paper.monthly()
```

ç¤ºä¾‹2:

```
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <p>ç©å®¶1æ•²å‡»é”®ç›˜ä¸Šçš„1ï¼Œç©å®¶2æ•²å‡»é”®ç›˜ä¸Šçš„0ï¼ˆåªæœ‰ä¸€åˆ†é’Ÿçš„æ—¶é—´ï¼ï¼‰</p>
    <div id="results"></div>
  </body>
  <script>
    var publisher = {
      subscribers: {
        any: [],
      },
      on: function (type, fn, context) {
        type = type || "any";
        fn = typeof fn === "function" ? fn : context[fn];
        if (typeof this.subscribers[type] === "undefined") {
          this.subscribers[type] = [];
        }
        this.subscribers[type].push({ fn: fn, context: context || this });
      },
      remove: function (type, fn, context) {
        this.visitSubscribers("unsubscribe", type, fn, context);
      },
      fire: function (type, publication) {
        this.visitSubscribers("publish", type, publication);
      },
      visitSubscribers: function (action, type, arg, context) {
        let n = 0;
        console.log(n);
        var pubType = type || "any",
          subscribers = this.subscribers[pubType],
          i,
          max = subscribers ? subscribers.length : 0;
        for (i = 0; i < max; i++) {
          if (action === "publish") {
            subscribers[i].fn.call(subscribers[i].context, arg);
          } else {
            if (
              subscribers[i].fn === arg &&
              subscribers[i].context === context
            ) {
              subscribers.splice(i, 1);
            }
          }
        }
      },
    };
    function makePublisher(o) {
      var i;
      for (i in publisher) {
        if (publisher.hasOwnProperty(i) && typeof publisher[i] === "function") {
          o[i] = publisher[i];
        }
      }
      o.subscribers = { any: [] };
    }
    function Player(name, key) {
      this.point = 0;
      this.name = name;
      this.key = key;
      this.fire("newPlayer", this);
    }
    Player.prototype.play = function () {
      this.point += 1;
      this.fire("play", this);
    };
    var game = {
      keys: {},
      addPlayer: function (player) {
        var key = player.key.toString().charCodeAt(0);
        this.keys[key] = player;
      },
      handleKeypress: function (e) {
        e = e || window.event;
        if (game.keys[e.which]) {
          game.keys[e.which].play();
        }
      },
      handlePlay: function (player) {
        var i,
          players = this.keys,
          score = {};
        for (i in players) {
          if (players.hasOwnProperty(i)) {
            score[players[i].name] = players[i].points;
          }
        }
        this.fire("scoreChange", score);
      },
    };
    var scoreboard = {
      element: document.getElementById("results"),
      update: function (score) {
        var i,
          msg = "";
        for (i in score) {
          if (score.hasOwnProperty(i)) {
            msg += `<p><strong>${i}</strong>:${score[i]}</p>`;
          }
        }
        this.element.innerHTML = msg;
      },
    };
    makePublisher(Player.prototype);
    makePublisher(game);

    Player.prototype.on("newPlayer", "addPlayer", game);
    Player.prototype.on("play", "handlePlay", game);
    game.on("scoreChange", scoreboard.update, scoreboard);
    window.onkeypress = game.handleKeypress;

    var playerName,
      key,
      num = 0;
    while (num < 1) {
      playerName = prompt("æ·»åŠ ç©å®¶");
      if (!playerName) {
        break;
      }
      while (num < 1) {
        key = prompt(`ç©å®¶${playerName}çš„é”®ä½`);
        num += 1;
        if (key) {
          break;
        }
      }
      new Player(playerName, key);
    }
  </script>
</html>

```

